<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<record id="mro_order_form_view" model="ir.ui.view">
            <field name="name">Orders Form</field>
            <field name="model">uis.papl.mro.order</field>
            <field name="arch" type="xml">
                <form string="Order Form">
						<sheet>
							<group>
								<group>
									<field name="id" attrs="{'invisible':'1'}"/>
									<field name="name"/>
									<field name="apl_id" widget="many2one_tags"/>
									<field name="create_date" class="oe_read_only"/>
									<field name="create_uid" class="oe_read_only"/>
								</group>>
								<group>
									<field name="start_planned_date"/>
									<field name="end_planned_date"/>
									<field name="take_to_work_date" class="oe_read_only"/>
									<field name="start_date" class="oe_read_only"/>
									<field name="end_date" class="oe_read_only"/>
								</group>
							</group>
							<notebook>
								<page string="Description">
									<field name="description"/>
								</page>
								<page string="Defects">
									<field name="defect_ids" domain="[('apl_id','=',apl_id),('state','=','confirmed')]">
										<tree>
											<field name="name"/>
											<field name="tap_ids"/>
											<field name="pillar_ids"/>
											<field name="transformer_ids"/>
											<field name="state"/>
											<field name="category"/>
										</tree>
									</field>>
								</page>
								<page string="Pillars">
									<group string="Pillars List">
										<field name="pillar_ids" nolabel="1" domain="[('apl_id','=',apl_id)]">
											<tree default_order="tap_id,num_by_vl">
												<field name="name"/>
												<field name="tap_id" invisible="1"/>
												<field name="num_by_vl"/>
												<field name="pillar_material_id"/>
												<field name="pillar_type_id"/>
												<field name="pillar_cut_id"/>
											</tree>
										</field>
									</group>
									<group string="Pillars from Defects" attrs="{'invisible':[('pillar_ids_from_defect', '=', [])]}">
										<field name="pillar_ids_from_defect" nolabel="1" domain="[('apl_id','=',apl_id)]" attrs="{'invisible':[('pillar_ids_from_defect', '=', [])]}">
											<tree default_order="tap_id,num_by_vl">
												<field name="name"/>
												<field name="tap_id" invisible="1"/>
												<field name="num_by_vl"/>
												<field name="pillar_material_id"/>
												<field name="pillar_type_id"/>
												<field name="pillar_cut_id"/>
											</tree>
										</field>
									</group>
								</page>
								<page string="Transformers">
									<group string="Transformers List">
										<field name="transformer_ids" nolabel="1" domain="[('apl_id','=',apl_id)]">
											<tree>
												<field name="name"/>
											</tree>
										</field>
									</group>
									<group string="Transfromers from Defects" attrs="{'invisible':[('transformer_ids_from_defect', '=', [])]}">
										<field name="transformer_ids_from_defect" nolabel="1" domain="[('apl_id','=',apl_id)]" attrs="{'invisible':[('transformer_ids_from_defect', '=', [])]}">
											<tree>
												<field name="name"/>
											</tree>
										</field>
									</group>
								</page>
								<page string="Taps">
									<group string="Taps List">
										<field name="tap_ids" nolabel="1" domain="[('apl_id','=',apl_id)]">
											<tree default_order="num_by_vl" fonts="bold:is_main_line==True" colors="blue:is_main_line==True">
												<field name="num_by_vl" invisible="1"/>
												<field name="name"/>
												<field name="conn_pillar_id"/>
												<field name="pillar_cnt"/>
												<field name="line_len_calc"/>
												<field name="is_main_line" invisible="1"/>
											</tree>
										</field>
									</group>
									<group string="Taps from Defects" attrs="{'invisible':[('tap_ids_from_defect', '=', [])]}">
										<field name="tap_ids_from_defect" nolabel="1" domain="[('apl_id','=',apl_id)]" attrs="{'invisible':[('tap_ids_from_defect', '=', [])]}">
											<tree default_order="num_by_vl" fonts="bold:is_main_line==True" colors="blue:is_main_line==True">
												<field name="num_by_vl" invisible="1"/>
												<field name="name"/>
												<field name="conn_pillar_id"/>
												<field name="pillar_cnt"/>
												<field name="line_len_calc"/>
												<field name="is_main_line" invisible="1"/>
											</tree>
										</field>
									</group>
								</page>
							</notebook>
						</sheet>
                </form>
            </field>
        </record>
		
		<record id="mro_order_tree_view" model="ir.ui.view">
            <field name="name">Orders Tree</field>
            <field name="model">uis.papl.mro.order</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="apl_id"/>
                </tree>
            </field>
        </record>
		
		<record id="papl_action_apl_orders" model="ir.actions.act_window">
            <field name="name">Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">uis.papl.mro.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree, form</field>
        </record>
		
		<record id="order_tree" model="ir.actions.act_window.view">
			<field eval="1" name="sequence"/>
			<field name="view_mode">tree</field>
			<field name="view_id" ref="mro_order_tree_view"/>
			<field name="act_window_id" ref="papl_action_apl_orders"/>
		</record>
		
		<record id="order_form" model="ir.actions.act_window.view">
			<field eval="2" name="sequence"/>
			<field name="view_mode">form</field>
			<field name="view_id" ref="mro_order_form_view"/>
			<field name="act_window_id" ref="papl_action_apl_orders"/>
		</record>
		
		<menuitem name="MRO" id="uis_papl_menu_mro" parent="passportvl.uis_papl_menu_root"/>

        <menuitem name="Maintance Orders"
			id="uis_papl_menu_mro_list" parent="uis_papl_menu_mro"
			action="papl_action_apl_orders"
			sequence="10"
			/>
 	</data>
</openerp>
